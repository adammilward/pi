(this["webpackJsonpthx1138-dev"]=this["webpackJsonpthx1138-dev"]||[]).push([[0],{16:function(e){e.exports=JSON.parse('{"apiUrl":"http://thx1138/van_data.php"}')},18:function(e,t,a){e.exports=a(27)},27:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(10),o=a.n(n),i=a(8),l=a(11),c=a(2),d=a(3),u=a(5),p=a(4),h=a(7),g=a(6),m=a(9),f=a(13),v=a(16),y=function(){function e(t){var a=this;Object(c.a)(this,e),this.isBusy=!1,this.queue=[],this.getData=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(a.isBusy)s&&a.queue.push({message:e,callBack:t,priority:s});else{a.isBusy=!0;fetch(a.apiUrl+"?message="+encodeURI(e),{method:"GET"}).then((function(e){return e.text()})).then((function(e){var s;a.isBusy=!1,a.processQueue();try{s=JSON.parse(e),t("success",s)}catch(r){console.warn(r),console.warn(e),a.errorCallBack("error",[r.toString(),e])}}),(function(e){a.isBusy=!1,a.processQueue(),console.warn(e),a.errorCallBack("error",[e])}))}},this.errorCallBack=t,this.apiUrl=v.apiUrl}return Object(d.a)(e,[{key:"processQueue",value:function(){if(this.queue.length){var e=this.queue.pop();this.getData(e.message,e.callBack,e.priority)}}}]),e}(),b=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).isDragged=!1,a.api=new y,a.state={values:[a.props.value]},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"actionDragged",value:function(e,t,a){e||this.isDragged&&this.props.actionDragged(this.state.values[0],this.props.name),this.isDragged=e,this.props.dragHold(e)}},{key:"slid",value:function(e){"undefined"!==this.props.allowedmax&&e>this.props.allowedmax&&(e=this.props.allowedmax),this.props.allowedmin&&e<this.props.allowedmin&&(e=this.props.allowedmin),this.setState({values:[e]})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{display:"flex",justifyContent:"center",flexWrap:"wrap",margin:"10px"}},r.a.createElement(f.Range,{values:this.state.values,step:.01,min:0,max:this.props.rangemax||255,onChange:function(t){return e.slid(t[0],e.props.name)},renderTrack:function(t){var a=t.props,s=t.children;return r.a.createElement("div",{style:Object(m.a)({},a.style,{height:"12px",display:"flex",width:"calc(100% - 5em)"})},r.a.createElement("div",{ref:a.ref,style:{height:"4px",width:"100%",borderRadius:"2px",background:Object(f.getTrackBackground)({values:e.state.values,colors:[e.props.color,"#999"],min:0,max:e.props.rangemax||255}),alignSelf:"center"}},s))},renderThumb:function(t){var a=t.props,s=t.isDragged;return r.a.createElement("div",Object.assign({},a,{onTouchEnd:e.actionDragged(s),style:Object(m.a)({},a.style,{height:"30px",width:"20px",borderRadius:"2px",backgroundColor:"#FFF",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0px 2px 6px #AAA"})}),r.a.createElement("div",{style:{height:"50%",width:"40%",backgroundColor:s?e.props.getColor(e.state.values[0]):e.props.color}}))}}),r.a.createElement("output",{className:"right",style:{margin:"0px 0px 0px 10px",width:"4em"},id:"output"},this.state.values[0].toFixed(1)))}}]),t}(r.a.Component),E=function(e){function t(){var e,a;Object(c.a)(this,t);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).wasDragged=!1,a.radio=function(e){a.props.sendRequest("lights "+e,1)},a.toggle=function(e){var t=a.slideModes[a.props.lightMode[1]].value;Boolean(a.props.delay)?a.props.sendRequest("lights static",1):a.props.sendRequest("lights "+t,1)},a.slideModes=[{name:"LIN",value:"lin"},{name:"SIN",value:"sin"},{name:"EXP",value:"exp"},{name:"S+E",value:"sinexp"}],a.actionDragged=function(e,t){a.props.sendRequest("lights "+t+" "+(Math.pow(2,e).toFixed()-1))},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"fadeButtons",value:function(){var e=this;return this.slideModes.map((function(t,a){var s=a===e.props.lightMode[1];return r.a.createElement("label",{key:t.name},t.name," ",r.a.createElement("br",null),r.a.createElement("input",{name:"fadeMode",key:t.value,onChange:function(){return e.radio(t.value)},checked:s,type:"radio"}))}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"lights-fade"},"Fade",r.a.createElement("label",{className:"switch float"},r.a.createElement("input",{type:"checkbox",checked:Boolean(this.props.delay),onChange:this.toggle}),r.a.createElement("span",{className:"switch-slider round right"}))),Boolean(this.props.delay)&&r.a.createElement("div",{className:"fade-settings right"},r.a.createElement("div",{className:"fade-mode"},this.fadeButtons()),r.a.createElement("div",{className:"fade-sliders"},"Delay \xa0 \xa0 \xa0 \xa0",r.a.createElement(b,{key:"delay"+this.props.count,name:"delay",value:this.props.delay,color:"#333",getColor:function(){return"rgb(100, 100, 100)"},allowedmin:0,allowedmax:8,rangemax:8,sendRequest:this.props.sendRequest,actionDragged:this.actionDragged,dragHold:this.props.dragHold}),"Upper \xa0 \xa0 \xa0 \xa0",r.a.createElement(b,{key:"u"+this.props.count,name:"u",value:this.props.u,color:"#999",getColor:function(){return"rgb(250, 250, 250)"},allowedmax:8,rangemax:8,allowedmin:0,sendRequest:this.props.sendRequest,actionDragged:this.actionDragged,dragHold:this.props.dragHold}),"Lower \xa0 \xa0 \xa0 \xa0",r.a.createElement(b,{key:"l"+this.props.count,name:"l",value:this.props.l,color:"#aaa",getColor:function(){return"rgb(50, 50, 50)"},allowedmax:8,rangemax:8,allowedmin:0,sendRequest:this.props.sendRequest,actionDragged:this.actionDragged,dragHold:this.props.dragHold}))))}}]),t}(r.a.Component),O=function(e){function t(){var e,a;Object(c.a)(this,t);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).actionDragged=function(e,t){a.props.sendRequest("lights "+t+" "+e)},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"lights",id:"lights"},r.a.createElement(b,{key:"r"+this.props.count,name:"r",value:this.props.r,color:"#f00",getColor:function(e){return"rgb("+Math.round(2.55*e)+", 0, 0)"},allowedmax:100,rangemax:100,slid:this.slid,sendRequest:this.props.sendRequest,actionDragged:this.actionDragged,dragHold:this.props.dragHold}),r.a.createElement(b,{key:"g"+this.props.count,name:"g",value:this.props.g,color:"#0f0",getColor:function(e){return"rgb(0, "+Math.round(2.55*e)+", 0)"},allowedmax:100,rangemax:100,slid:this.slid,sendRequest:this.props.sendRequest,actionDragged:this.actionDragged,dragHold:this.props.dragHold}),r.a.createElement(b,{key:"b"+this.props.count,name:"b",value:this.props.b,color:"#00f",getColor:function(e){return"rgb(0, 0, "+Math.round(2.55*e)+")"},allowedmax:100,rangemax:100,slid:this.slid,sendRequest:this.props.sendRequest,actionDragged:this.actionDragged,dragHold:this.props.dragHold}),r.a.createElement(E,Object.assign({},this.props,{bottomSlid:this.bottomSlid})))}}]),t}(r.a.Component),x=function(e){return Object(i.d)().show(e.alert.message,Object(m.a)({},e.alert)),r.a.createElement(r.a.Fragment,null)},j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(p.a)(t).call(this,e))).pendingOff=!1,a.isDragged=!1,a.receiveResponse=function(e,t){t.forEach((function(t){Array.isArray(t)?a.receiveResponse(e,t):"object"===typeof t&&("lights"===t.mode?a.processLightsData(t):t.info||t.err&&a.setState({alert:{message:t.err,type:"error"}}))}))},a.toggle=function(e){a.pendingOff=a.state.on,a.sendRequest(a.state.on?"lights off":"lights on",(function(){return a.receiveResponse}),1)},a.state={on:!1,r:0,g:0,b:0,l:1,u:255,lightMode:[0,3],delay:0,fadeDelay:0,reportDelay:0,count:0},a.sendRequest("lights report"),a.dragHold=a.dragHold.bind(Object(h.a)(a)),a.sendRequest=a.sendRequest.bind(Object(h.a)(a)),a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"sendRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"lights report",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.receiveResponse;console.log("request: ",e),this.props.api.getData(e,this.receiveResponse,t)}},{key:"dragHold",value:function(e){this.isDragged=e}},{key:"processLightsData",value:function(e){var t=this;if(clearTimeout(this.requestTime),"object"===typeof e&&!this.isDragged){console.log("recieved: ",e);var a={r:e.r<0?0:e.r>255?255:e.r,g:e.g<0?0:e.g>255?255:e.g,b:e.b<0?0:e.b>255?255:e.b,l:Math.log2(1+(e.l<0?0:e.l>255?255:e.l)),u:Math.log2(1+(e.u<0?0:e.u>255?255:e.u)),lightMode:e.lightMode,delay:Math.log2(e.delay+1),fadeDelay:e.fadeDelay,reportDelay:e.reportDelay,count:this.state.count+1};if(console.log("setState: ",a),this.setState(Object(m.a)({},a,{on:Boolean(a.r||a.g||a.b)})),a.fadeDelay||a.delay){var s=a.fadeDelay>a.delay?a.fadeDelay/20:500*a.delay;this.requestTime=setTimeout((function(){return t.sendRequest()}),s)}else this.requestTime=setTimeout((function(){return t.sendRequest()}),3e4)}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("label",{className:"switch float"},r.a.createElement("input",{type:"checkbox",checked:this.state.on&&!this.pendingOff,onChange:this.toggle}),r.a.createElement("span",{className:"switch-slider round right"})),this.state.on&&r.a.createElement(O,Object.assign({},this.state,{sendRequest:this.sendRequest,dragHold:this.dragHold})),this.state.alert&&r.a.createElement(x,{alert:this.state.alert}))}}]),t}(r.a.Component);var D=a(17),k=a.n(D),w=function(e){function t(e){var a;Object(c.a)(this,t),a=Object(u.a)(this,Object(p.a)(t).call(this,e));var s=k()();a.state={time:s};var r=s.format("H");return a.timeOfDay="day",a.timeOfDay=r<12?"morning":r>=12&&r<17?"afternoon":"night",a.displayErrors=a.displayErrors.bind(Object(h.a)(a)),a.api=new y(a.displayErrors),a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"displayErrors",value:function(e,t){var a=this;t.forEach((function(t){a.setState({alert:{message:t,type:e}})}))}},{key:"render",value:function(){var e={position:i.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:i.c.SCALE};return r.a.createElement(i.a,Object.assign({template:l.a},e),r.a.createElement("div",{className:"container",id:"container"},r.a.createElement("p",null,r.a.createElement("span",null,this.state.time.format("ddd Do MMM HH:mm:ss")),r.a.createElement("span",{className:"right"},"Good ",this.timeOfDay)),r.a.createElement(j,{api:this.api})),this.state.alert&&r.a.createElement(x,{alert:this.state.alert}))}}]),t}(r.a.Component),R={position:i.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:i.c.SCALE};o.a.render(r.a.createElement(i.a,Object.assign({template:l.a},R),r.a.createElement(w,null)),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.9d023b14.chunk.js.map